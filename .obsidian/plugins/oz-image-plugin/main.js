/*
THIS IS A GENERATED/BUNDLED FILE BY ROLLUP
if you want to view the source visit the plugins github repository
*/

'use strict';

var obsidian = require('obsidian');

/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */

function __awaiter(thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

class WidgetHandler {
}
// Remove Widgets in CodeMirror Editor
WidgetHandler.clearWidgets = (cm) => {
    var lastLine = cm.lastLine();
    for (let i = 0; i <= lastLine; i++) {
        const line = cm.lineInfo(i);
        WidgetHandler.clearLineWidgets(line);
    }
};
// Clear Single Line Widget
WidgetHandler.clearLineWidgets = (line) => {
    if (line.widgets) {
        for (const wid of line.widgets) {
            if (wid.className === 'oz-image-widget') {
                wid.clear();
            }
        }
    }
};
class LinkHandler {
}
LinkHandler.link_regex = /(http[s]?:\/\/)([^\/\s]+\/)(.*)/;
LinkHandler.image_http_regex_3 = /!\[\[[a-z][a-z0-9+\-.]+:\/.*\]\]/;
LinkHandler.image_http_regex_4 = /!\[[^)]*\]\([a-z][a-z0-9+\-.]+:\/[^)]*\)/;
// Check if String is a link
LinkHandler.path_is_a_link = (path) => {
    let match = path.match(LinkHandler.link_regex);
    return match ? true : false;
};
// Check line if it is a link
LinkHandler.get_link_in_line = (line) => {
    const match_3 = line.match(LinkHandler.image_http_regex_3);
    const match_4 = line.match(LinkHandler.image_http_regex_4);
    if (match_3) {
        return { result: match_3, linkType: 3 };
    }
    else if (match_4) {
        return { result: match_4, linkType: 4 };
    }
    return { result: false, linkType: 0 };
};
class PDFHandler {
}
// Regex for [[ ]] format
PDFHandler.pdf_regex_1 = /!\[\[.*(pdf)\]\]/;
PDFHandler.pdf_name_regex_1 = /(?<=\[\[).*.pdf/;
// Regex for ![ ]( ) format
PDFHandler.pdf_regex_2 = /!\[(^$|.*)\]\(.*(pdf)\)/;
PDFHandler.pdf_name_regex_2 = /(?<=\().*.pdf/;
// Check line if it is a PDF
PDFHandler.get_pdf_in_line = (line) => {
    const match_1 = line.match(PDFHandler.pdf_regex_1);
    const match_2 = line.match(PDFHandler.pdf_regex_2);
    if (match_1) {
        return { result: match_1, linkType: 1 };
    }
    else if (match_2) {
        return { result: match_2, linkType: 2 };
    }
    return { result: false, linkType: 0 };
};
PDFHandler.get_pdf_name = (linkType, match) => {
    let pdf_name_regex;
    if (linkType == 1)
        pdf_name_regex = PDFHandler.pdf_name_regex_1;
    if (linkType == 2)
        pdf_name_regex = PDFHandler.pdf_name_regex_2;
    var file_name_match = match[0].match(pdf_name_regex);
    return file_name_match[0];
};
class ImageHandler {
}
// General Image Regex 
ImageHandler.image_regex = /.*.(jpe?g|png|gif|svg|bmp|excalidraw)/;
// Regex for [[ ]] format
ImageHandler.image_line_regex_1 = /!\[\[.*?(jpe?g|png|gif|svg|bmp|excalidraw).*?\]\]/;
ImageHandler.file_name_regex_1 = /(?<=\[\[).*(jpe?g|png|gif|svg|bmp|excalidraw)/;
// Regex for ![ ]( ) format
ImageHandler.image_line_regex_2 = /!\[(^$|.*?)\]\(.*?(jpe?g|png|gif|svg|bmp|excalidraw)\)/;
ImageHandler.file_name_regex_2 = /(?<=\().*(jpe?g|png|gif|svg|bmp|excalidraw)/;
// Regex for Links
ImageHandler.file_name_regex_3 = /(?<=\[\[).*(?=\|)|(?<=\[\[).*(?=\]\])/;
ImageHandler.file_name_regex_4 = /(?<=\().*(?=\))/;
// Check line if it is image
ImageHandler.get_image_in_line = (line) => {
    const match_1 = line.match(ImageHandler.image_line_regex_1);
    const match_2 = line.match(ImageHandler.image_line_regex_2);
    if (match_1) {
        return { result: match_1, linkType: 1 };
    }
    else if (match_2) {
        return { result: match_2, linkType: 2 };
    }
    return { result: false, linkType: 0 };
};
// Image Name and Alt Text
ImageHandler.getFileNameAndAltText = (linkType, match) => {
    /*
        linkType 1: ![[myimage.jpg|#x-small]], linkType 3: ![[https://image|#x-small]],
        linkType 2: ![#x-small](myimage.jpg),  linkType 4: ![#x-small](https://image)
        returns { fileName: '', altText: '' }
    */
    var file_name_regex;
    var alt_regex;
    if (linkType == 1 || linkType == 3) {
        if (linkType == 1)
            file_name_regex = ImageHandler.file_name_regex_1;
        if (linkType == 3)
            file_name_regex = ImageHandler.file_name_regex_3;
        alt_regex = /(?<=\|).*(?=]])/;
    }
    else if (linkType == 2 || linkType == 4) {
        if (linkType == 2)
            file_name_regex = ImageHandler.file_name_regex_2;
        if (linkType == 4)
            file_name_regex = ImageHandler.file_name_regex_4;
        alt_regex = /(?<=\[)(^$|.*)(?=\])/;
    }
    var file_match = match[0].match(file_name_regex);
    var alt_match = match[0].match(alt_regex);
    return {
        fileName: file_match ? file_match[0] : '',
        altText: alt_match ? alt_match[0] : ''
    };
};
// Checking the Alt 100x100 (WIDTHxHEIGHT) format
ImageHandler.altWidthHeight = (altText) => {
    const widthHeightRegex = /[0-9]+x[0-9]+/;
    const widthRegex = /[0-9]+/;
    var match = altText.match(widthHeightRegex);
    if (match) {
        var index = match[0].indexOf('x');
        return {
            width: parseInt(match[0].substr(0, index)),
            height: parseInt(match[0].substr(index + 1))
        };
    }
    else {
        var widthMatch = altText.match(widthRegex);
        if (widthMatch)
            return { width: parseInt(widthMatch[0]) };
    }
    return false;
};
// Check if path is an image
ImageHandler.is_an_image = (path) => {
    var match = path.match(ImageHandler.image_regex);
    if (match)
        return true;
    return false;
};
class IframeHandler {
}
IframeHandler.iframeRegex = /(?:<iframe[^>]*)(?:(?:\/>)|(?:>.*?<\/iframe>))/;
IframeHandler.get_iframe_in_line = (line) => {
    const match = line.match(IframeHandler.iframeRegex);
    if (match)
        return { result: match, linkType: 'iframe' };
    return { result: false, linkType: 0 };
};
IframeHandler.create_iframe_node = (match) => {
    var iframeNode = document.createElement('div');
    iframeNode.innerHTML = match[0].trim();
    return iframeNode;
};
class ObsidianHelpers {
}
// Getting Active Markdown File
ObsidianHelpers.getActiveNoteFile = (workspace) => {
    return workspace.getActiveFile();
};
// Get Active Editor
ObsidianHelpers.getCmEditor = (workspace) => {
    var _a, _b;
    return (_b = (_a = workspace.getActiveViewOfType(obsidian.MarkdownView)) === null || _a === void 0 ? void 0 : _a.sourceMode) === null || _b === void 0 ? void 0 : _b.cmEditor;
};
// Get Full Path of the image
ObsidianHelpers.getPathOfImage = (vault, image) => {
    return vault.getResourcePath(image) + '?' + image.stat.mtime;
};
ObsidianHelpers.getFileCmBelongsTo = (cm, workspace) => {
    var _a;
    let leafs = workspace.getLeavesOfType("markdown");
    for (let i = 0; i < leafs.length; i++) {
        // @ts-ignore
        if (leafs[i].view instanceof obsidian.MarkdownView && ((_a = leafs[i].view.sourceMode) === null || _a === void 0 ? void 0 : _a.cmEditor) == cm) {
            // @ts-ignore
            return leafs[i].view.file;
        }
    }
    return null;
};

// Check Single Line
const check_line = (cm, line_number, targetFile, app, settings, changedFilePath) => __awaiter(void 0, void 0, void 0, function* () {
    // Get the Line edited
    const line = cm.lineInfo(line_number);
    if (line === null)
        return;
    // Check if the line is an internet link
    const link_in_line = LinkHandler.get_link_in_line(line.text);
    const img_in_line = ImageHandler.get_image_in_line(line.text);
    // Clear the widget if link was removed
    var line_image_widget = line.widgets ? line.widgets.filter((wid) => wid.className === 'oz-image-widget') : false;
    if (line_image_widget && !(img_in_line.result || link_in_line.result))
        line_image_widget[0].clear();
    // Render iFrame if it is turned on
    if (settings && settings.renderIframe) {
        // Check if the line is a Iframe
        const iframe_in_line = IframeHandler.get_iframe_in_line(line.text);
        // If Regex Matches
        if (iframe_in_line.result) {
            // Clear the Line Widgets
            WidgetHandler.clearLineWidgets(line);
            // Create Iframe Node
            var iframeNode = IframeHandler.create_iframe_node(iframe_in_line.result);
            // Add Widget in Line
            cm.addLineWidget(line_number, iframeNode, { className: 'oz-image-widget' });
            // End Rendering of the line
            return;
        }
    }
    var sourcePath = '';
    // Render PDF if it is turned on
    if (settings && settings.renderPDF) {
        // Check if the line is a  PDF 
        const pdf_in_line = PDFHandler.get_pdf_in_line(line.text);
        // If PDF Regex Matches
        if (pdf_in_line.result) {
            // Clear the Line Widgets
            WidgetHandler.clearLineWidgets(line);
            // Get Source Path
            if (targetFile != null)
                sourcePath = targetFile.path;
            // Get PDF File
            var pdf_name = PDFHandler.get_pdf_name(pdf_in_line.linkType, pdf_in_line.result);
            // Create URL for Link and Local PDF 
            var pdf_path = '';
            if (LinkHandler.path_is_a_link(pdf_name)) {
                pdf_path = pdf_name;
            }
            else {
                // Get the PDF File Object
                var pdfFile = app.metadataCache.getFirstLinkpathDest(decodeURIComponent(pdf_name), sourcePath);
                // Create Object URL
                var buffer = yield app.vault.adapter.readBinary(obsidian.normalizePath(pdfFile.path));
                var arr = new Uint8Array(buffer);
                var blob = new Blob([arr], { type: 'application/pdf' });
                pdf_path = URL.createObjectURL(blob);
            }
            // Create the Widget
            var pdf_widget = document.createElement('embed');
            pdf_widget.src = pdf_path;
            pdf_widget.type = 'application/pdf';
            pdf_widget.width = '500';
            pdf_widget.height = '650';
            // Add Widget in Line
            cm.addLineWidget(line_number, pdf_widget, { className: 'oz-image-widget' });
            // End Rendering of the line
            return;
        }
    }
    // If any of regex matches, it will add image widget
    if (link_in_line.result || img_in_line.result) {
        // Get the file name and alt text depending on format
        var filename = '';
        var alt = '';
        if (link_in_line.result) {
            // linkType 3 and 4
            filename = ImageHandler.getFileNameAndAltText(link_in_line.linkType, link_in_line.result).fileName;
            alt = ImageHandler.getFileNameAndAltText(link_in_line.linkType, link_in_line.result).altText;
        }
        else if (img_in_line.result) {
            filename = ImageHandler.getFileNameAndAltText(img_in_line.linkType, img_in_line.result).fileName;
            alt = ImageHandler.getFileNameAndAltText(img_in_line.linkType, img_in_line.result).altText;
        }
        // Create Image
        const img = document.createElement('img');
        var image = null;
        // Prepare the src for the Image
        if (link_in_line.result) {
            img.src = filename;
        }
        else {
            // Source Path
            if (targetFile != null) {
                sourcePath = targetFile.path;
            }
            else {
                let activeNoteFile = ObsidianHelpers.getActiveNoteFile(app.workspace);
                sourcePath = activeNoteFile ? activeNoteFile.path : '';
            }
            var imageFile = app.metadataCache.getFirstLinkpathDest(decodeURIComponent(filename), sourcePath);
            // Additional Check for Changed Files - helps updating only for changed image
            if (changedFilePath && imageFile && changedFilePath !== imageFile.path)
                return;
            if (filename.endsWith('excalidraw')) {
                // The file is an excalidraw drawing
                // @ts-ignore
                if (app.plugins.getPlugin('obsidian-excalidraw-plugin')) {
                    if (imageFile == null)
                        return;
                    var mtimeAlt = imageFile.stat.mtime + '-' + alt;
                    var loadedDrawing = document.querySelector(`[mtimeAlt='${mtimeAlt}']`);
                    if (loadedDrawing == null) {
                        // @ts-ignore
                        ExcalidrawAutomate.reset();
                        // @ts-ignore
                        image = yield ExcalidrawAutomate.createPNG(imageFile.path);
                        img.src = URL.createObjectURL(image);
                        img.setAttr("mtimeAlt", mtimeAlt);
                    }
                    else {
                        return;
                    }
                }
            }
            else {
                // The file is an image
                if (imageFile == null)
                    return;
                img.src = ObsidianHelpers.getPathOfImage(app.vault, imageFile);
            }
        }
        // Clear the image widgets if exists
        WidgetHandler.clearLineWidgets(line);
        // Image Properties
        var altSizer = ImageHandler.altWidthHeight(alt);
        if (altSizer) {
            img.width = altSizer.width;
            if (altSizer.height)
                img.height = altSizer.height;
        }
        img.alt = alt;
        // Add Image widget under the Image Markdown
        cm.addLineWidget(line_number, img, { className: 'oz-image-widget' });
    }
});
// Check All Lines Function
const check_lines = (cm, from, to, app, settings, changedFilePath) => {
    // Last Used Line Number in Code Mirror
    var file = ObsidianHelpers.getFileCmBelongsTo(cm, app.workspace);
    for (let i = from; i <= to; i++) {
        check_line(cm, i, file, app, settings, changedFilePath);
    }
};

class OzanImagePluginSettingsTab extends obsidian.PluginSettingTab {
    constructor(app, plugin) {
        super(app, plugin);
        this.plugin = plugin;
    }
    display() {
        let { containerEl } = this;
        containerEl.empty();
        containerEl.createEl('h2', { text: 'Image in Editor Settings' });
        containerEl.createEl('h2', { text: 'Render Options' });
        new obsidian.Setting(containerEl)
            .setName('Render Toggle')
            .setDesc('Turn off this option if you want to stop rendering images, PDF and drawings. If you turn off, the other settings won\'t have an effect')
            .addToggle((toggle) => toggle
            .setValue(this.plugin.settings.renderAll)
            .onChange((value) => {
            this.plugin.handleToggleRenderAll(value);
            this.plugin.settings.renderAll = value;
            this.plugin.saveSettings();
        }));
        new obsidian.Setting(containerEl)
            .setName('Render PDFs in Editor')
            .setDesc('Turn on this option if you want also PDF files to be rendered in Editor')
            .addToggle((toggle) => toggle
            .setValue(this.plugin.settings.renderPDF)
            .onChange((value) => {
            this.plugin.settings.renderPDF = value;
            this.plugin.saveSettings();
        }));
        new obsidian.Setting(containerEl)
            .setName('Render Iframes in Editor')
            .setDesc('Turn on this option if you want iframes to be rendered in Editor')
            .addToggle((toggle) => toggle
            .setValue(this.plugin.settings.renderIframe)
            .onChange((value) => {
            this.plugin.settings.renderIframe = value;
            this.plugin.saveSettings();
        }));
        this.containerEl.createEl('h2', { text: 'Alternative Settings' });
        new obsidian.Setting(containerEl)
            .setName('Refresh Images after Changes')
            .setDesc('Turn on this option if you want images to refreshed once you edit the original file')
            .addToggle((toggle) => toggle
            .setValue(this.plugin.settings.refreshImagesAfterChange)
            .onChange((value) => {
            this.plugin.handleRefreshImages(value);
            this.plugin.settings.refreshImagesAfterChange = value;
            this.plugin.saveSettings();
        }));
        new obsidian.Setting(containerEl)
            .setName('WYSIWYG Like Experience')
            .setDesc('Turn on this option if you want WYSIWYG style to be loaded for editor view')
            .addToggle((toggle) => toggle
            .setValue(this.plugin.settings.WYSIWYG)
            .onChange((value) => {
            this.plugin.settings.WYSIWYG = value;
            this.plugin.handleWYSIWYG(value);
            this.plugin.saveSettings();
        }));
    }
}

const WYSIWYG_Style = `

/* Not Active Lines */
div:not(.CodeMirror-activeline) >
.CodeMirror-line span.cm-formatting:not(.cm-formatting-list) /* not(.cm-formatting-code-block) */ {
  display: none !important;
}

/* H1 Underline */
.cm-s-obsidian pre.HyperMD-header-1:after {
  content: "";
  position: absolute;
  bottom: 5px;
  left: 5px;
  width: calc(100% - 10px);
  height: 1px;
  background: var(--text-accent);
}

/* except numbered list */
div:not(.CodeMirror-activeline)>.CodeMirror-line span.cm-formatting-list {
   display: inline !important;
}

span.cm-formatting-list,
span.cm-formatting-code-block.cm-hmd-codeblock,
span.cm-formatting-header {
  display: inline !important;
}

/* and task checkboxes */
span.cm-formatting-task {
  display: inline !important;
  font-family: monospace;
}

/* highlight (==) not visible anymore if not active line */
div:not(.CodeMirror-activeline) > .CodeMirror-line .cm-formatting-highlight.cm-highlight {
 font-size: 0;
}

/* Blockquote */
div:not(.CodeMirror-activeline)>.CodeMirror-line span.cm-formatting.cm-formatting-quote,
div:not(.CodeMirror-activeline)>.CodeMirror-line span.cm-hmd-indent-in-quote {
  display: inline !important;
  color: transparent !important;
}

div:not(.CodeMirror-activeline)>.HyperMD-quote {
   background-color:rgb(238, 234, 234);
   border-left: 3px solid var(--text-selection);
   border-color: red !important;
   font-size: 17px;
   line-height: 1.5em;
   margin-left: 5px;
   padding: 10px 6px 10px 6px;
   display: inline-block;
   width: 100%;
}

/* Tags */
div:not(.CodeMirror-activeline) > .CodeMirror-line span.cm-hashtag-end:before {
   content: '';
}

.tag, div:not(.CodeMirror-activeline) > .CodeMirror-line span.cm-hashtag-end {
  background-color: #bd6b19;
  border: none;
  color: white !important;
  font-size: 14px;
  padding: 0px 8px;
  padding-top: -2px;
  padding-bottom: 3px;
  text-align: center;
  text-decoration: none !important;
  display: inline-block;
  margin: 1px 1px;
  cursor: pointer;
  border-radius: 14px;
}

`;

const DEFAULT_SETTINGS = {
    renderAll: true,
    renderPDF: false,
    renderIframe: false,
    refreshImagesAfterChange: false,
    WYSIWYG: false
};
class OzanImagePlugin extends obsidian.Plugin {
    constructor() {
        super(...arguments);
        // Line Edit Changes
        this.codemirrorLineChanges = (cm, change) => {
            check_lines(cm, change.from.line, change.from.line + change.text.length - 1, this.app, this.settings);
        };
        // Only Triggered during initial Load
        this.handleInitialLoad = (cm) => {
            var lastLine = cm.lastLine();
            var file = ObsidianHelpers.getFileCmBelongsTo(cm, this.app.workspace);
            for (let i = 0; i < lastLine + 1; i++) {
                check_line(cm, i, file, this.app, this.settings);
            }
        };
        // Handle Toggle for renderAll
        this.handleToggleRenderAll = (newRenderAll) => {
            if (newRenderAll) {
                this.registerCodeMirror((cm) => {
                    cm.on("change", this.codemirrorLineChanges);
                    this.handleInitialLoad(cm);
                });
                if (this.settings.refreshImagesAfterChange)
                    this.app.vault.on('modify', this.handleFileModify);
            }
            else {
                this.app.workspace.iterateCodeMirrors((cm) => {
                    cm.off("change", this.codemirrorLineChanges);
                    WidgetHandler.clearWidgets(cm);
                });
                this.app.vault.off('modify', this.handleFileModify);
            }
        };
        // Handle Toggle for Refresh Images Settings
        this.handleRefreshImages = (newRefreshImages) => {
            if (newRefreshImages) {
                this.app.vault.on('modify', this.handleFileModify);
            }
            else {
                this.app.vault.off('modify', this.handleFileModify);
            }
        };
        // Handle File Changes to Refhres Images
        this.handleFileModify = (file) => {
            if (!(file instanceof obsidian.TFile))
                return;
            if (!ImageHandler.is_an_image(file.path))
                return;
            this.app.workspace.iterateCodeMirrors(cm => {
                var lastLine = cm.lastLine();
                check_lines(cm, 0, lastLine, this.app, this.settings, file.path);
            });
        };
        // Handle WYSIWYG Toggle
        this.handleWYSIWYG = (newWYSIWYG) => {
            if (newWYSIWYG) {
                this.load_WYSIWYG_Styles();
            }
            else {
                this.unload_WYSIWYG_Styles();
            }
        };
        this.load_WYSIWYG_Styles = () => {
            this.loadedStyles = Array(0);
            var style = document.createElement("style");
            style.innerHTML = WYSIWYG_Style;
            document.head.appendChild(style);
            this.loadedStyles.push(style);
        };
        this.unload_WYSIWYG_Styles = () => {
            for (let style of this.loadedStyles) {
                document.head.removeChild(style);
            }
            this.loadedStyles = Array(0);
        };
    }
    onload() {
        return __awaiter(this, void 0, void 0, function* () {
            console.log('Image in Editor Plugin is loaded');
            this.addSettingTab(new OzanImagePluginSettingsTab(this.app, this));
            yield this.loadSettings();
            // Register event for each change
            this.addCommand({
                id: 'toggle-render-all',
                name: 'Toggle Render All',
                callback: () => {
                    this.handleToggleRenderAll(!this.settings.renderAll);
                    this.settings.renderAll = !this.settings.renderAll;
                    this.saveSettings();
                }
            });
            if (this.settings.WYSIWYG)
                this.load_WYSIWYG_Styles();
            if (!this.settings.renderAll)
                return;
            this.registerCodeMirror((cm) => {
                cm.on("change", this.codemirrorLineChanges);
                this.handleInitialLoad(cm);
            });
            if (!this.settings.refreshImagesAfterChange)
                return;
            this.app.vault.on('modify', this.handleFileModify);
        });
    }
    onunload() {
        this.app.workspace.iterateCodeMirrors((cm) => {
            cm.off("change", this.codemirrorLineChanges);
            WidgetHandler.clearWidgets(cm);
        });
        this.app.vault.off('modify', this.handleFileModify);
        this.unload_WYSIWYG_Styles();
        console.log('Image in Editor Plugin is unloaded');
    }
    loadSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
        });
    }
    saveSettings() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this.saveData(this.settings);
        });
    }
}

module.exports = OzanImagePlugin;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXMiOlsibm9kZV9tb2R1bGVzL3RzbGliL3RzbGliLmVzNi5qcyIsInNyYy91dGlscy50cyIsInNyYy9jaGVjay1saW5lLnRzIiwic3JjL3NldHRpbmdzLnRzIiwic3JjL2NvbnN0YW50cy50cyIsInNyYy9tYWluLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cclxuXHJcblBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueVxyXG5wdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXHJcblxyXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIXHJcblJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxyXG5BTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsXHJcbklORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTVxyXG5MT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxyXG5PVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SXHJcblBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcclxuICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXh0ZW5kcyhkLCBiKSB7XHJcbiAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxyXG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMCAmJiBPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwocywgcFtpXSkpXHJcbiAgICAgICAgICAgICAgICB0W3BbaV1dID0gc1twW2ldXTtcclxuICAgICAgICB9XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgZnVuY3Rpb24gYWRvcHQodmFsdWUpIHsgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUCA/IHZhbHVlIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZSh2YWx1ZSk7IH0pOyB9XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fY3JlYXRlQmluZGluZyA9IE9iamVjdC5jcmVhdGUgPyAoZnVuY3Rpb24obywgbSwgaywgazIpIHtcclxuICAgIGlmIChrMiA9PT0gdW5kZWZpbmVkKSBrMiA9IGs7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobywgazIsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIG1ba107IH0gfSk7XHJcbn0pIDogKGZ1bmN0aW9uKG8sIG0sIGssIGsyKSB7XHJcbiAgICBpZiAoazIgPT09IHVuZGVmaW5lZCkgazIgPSBrO1xyXG4gICAgb1trMl0gPSBtW2tdO1xyXG59KTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgbykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAocCAhPT0gXCJkZWZhdWx0XCIgJiYgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvLCBwKSkgX19jcmVhdGVCaW5kaW5nKG8sIG0sIHApO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSBcIm51bWJlclwiKSByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyBcIk9iamVjdCBpcyBub3QgaXRlcmFibGUuXCIgOiBcIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG4vKiogQGRlcHJlY2F0ZWQgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG4vKiogQGRlcHJlY2F0ZWQgKi9cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXlzKCkge1xyXG4gICAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBzICs9IGFyZ3VtZW50c1tpXS5sZW5ndGg7XHJcbiAgICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspXHJcbiAgICAgICAgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspXHJcbiAgICAgICAgICAgIHJba10gPSBhW2pdO1xyXG4gICAgcmV0dXJuIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZEFycmF5KHRvLCBmcm9tKSB7XHJcbiAgICBmb3IgKHZhciBpID0gMCwgaWwgPSBmcm9tLmxlbmd0aCwgaiA9IHRvLmxlbmd0aDsgaSA8IGlsOyBpKyssIGorKylcclxuICAgICAgICB0b1tqXSA9IGZyb21baV07XHJcbiAgICByZXR1cm4gdG87XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlbbl0gPSBvW25dID8gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbnZhciBfX3NldE1vZHVsZURlZmF1bHQgPSBPYmplY3QuY3JlYXRlID8gKGZ1bmN0aW9uKG8sIHYpIHtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvLCBcImRlZmF1bHRcIiwgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdiB9KTtcclxufSkgOiBmdW5jdGlvbihvLCB2KSB7XHJcbiAgICBvW1wiZGVmYXVsdFwiXSA9IHY7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChrICE9PSBcImRlZmF1bHRcIiAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9kLCBrKSkgX19jcmVhdGVCaW5kaW5nKHJlc3VsdCwgbW9kLCBrKTtcclxuICAgIF9fc2V0TW9kdWxlRGVmYXVsdChyZXN1bHQsIG1vZCk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnREZWZhdWx0KG1vZCkge1xyXG4gICAgcmV0dXJuIChtb2QgJiYgbW9kLl9fZXNNb2R1bGUpID8gbW9kIDogeyBkZWZhdWx0OiBtb2QgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fY2xhc3NQcml2YXRlRmllbGRHZXQocmVjZWl2ZXIsIHN0YXRlLCBraW5kLCBmKSB7XHJcbiAgICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBnZXR0ZXJcIik7XHJcbiAgICBpZiAodHlwZW9mIHN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyByZWNlaXZlciAhPT0gc3RhdGUgfHwgIWYgOiAhc3RhdGUuaGFzKHJlY2VpdmVyKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCByZWFkIHByaXZhdGUgbWVtYmVyIGZyb20gYW4gb2JqZWN0IHdob3NlIGNsYXNzIGRpZCBub3QgZGVjbGFyZSBpdFwiKTtcclxuICAgIHJldHVybiBraW5kID09PSBcIm1cIiA/IGYgOiBraW5kID09PSBcImFcIiA/IGYuY2FsbChyZWNlaXZlcikgOiBmID8gZi52YWx1ZSA6IHN0YXRlLmdldChyZWNlaXZlcik7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHJlY2VpdmVyLCBzdGF0ZSwgdmFsdWUsIGtpbmQsIGYpIHtcclxuICAgIGlmIChraW5kID09PSBcIm1cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgbWV0aG9kIGlzIG5vdCB3cml0YWJsZVwiKTtcclxuICAgIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIHNldHRlclwiKTtcclxuICAgIGlmICh0eXBlb2Ygc3RhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHJlY2VpdmVyICE9PSBzdGF0ZSB8fCAhZiA6ICFzdGF0ZS5oYXMocmVjZWl2ZXIpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IHdyaXRlIHByaXZhdGUgbWVtYmVyIHRvIGFuIG9iamVjdCB3aG9zZSBjbGFzcyBkaWQgbm90IGRlY2xhcmUgaXRcIik7XHJcbiAgICByZXR1cm4gKGtpbmQgPT09IFwiYVwiID8gZi5jYWxsKHJlY2VpdmVyLCB2YWx1ZSkgOiBmID8gZi52YWx1ZSA9IHZhbHVlIDogc3RhdGUuc2V0KHJlY2VpdmVyLCB2YWx1ZSkpLCB2YWx1ZTtcclxufVxyXG4iLCJpbXBvcnQgeyBXb3Jrc3BhY2UsIE1hcmtkb3duVmlldywgVmF1bHQsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgY2xhc3MgV2lkZ2V0SGFuZGxlciB7XG5cbiAgICAvLyBSZW1vdmUgV2lkZ2V0cyBpbiBDb2RlTWlycm9yIEVkaXRvclxuICAgIHN0YXRpYyBjbGVhcldpZGdldHMgPSAoY206IENvZGVNaXJyb3IuRWRpdG9yKSA9PiB7XG4gICAgICAgIHZhciBsYXN0TGluZSA9IGNtLmxhc3RMaW5lKCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IGxhc3RMaW5lOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBjbS5saW5lSW5mbyhpKTtcbiAgICAgICAgICAgIFdpZGdldEhhbmRsZXIuY2xlYXJMaW5lV2lkZ2V0cyhsaW5lKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIENsZWFyIFNpbmdsZSBMaW5lIFdpZGdldFxuICAgIHN0YXRpYyBjbGVhckxpbmVXaWRnZXRzID0gKGxpbmU6IGFueSkgPT4ge1xuICAgICAgICBpZiAobGluZS53aWRnZXRzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHdpZCBvZiBsaW5lLndpZGdldHMpIHtcbiAgICAgICAgICAgICAgICBpZiAod2lkLmNsYXNzTmFtZSA9PT0gJ296LWltYWdlLXdpZGdldCcpIHtcbiAgICAgICAgICAgICAgICAgICAgd2lkLmNsZWFyKClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbn1cblxuZXhwb3J0IGNsYXNzIExpbmtIYW5kbGVyIHtcblxuICAgIHN0YXRpYyBsaW5rX3JlZ2V4ID0gLyhodHRwW3NdPzpcXC9cXC8pKFteXFwvXFxzXStcXC8pKC4qKS87XG4gICAgc3RhdGljIGltYWdlX2h0dHBfcmVnZXhfMyA9IC8hXFxbXFxbW2Etel1bYS16MC05K1xcLS5dKzpcXC8uKlxcXVxcXS87XG4gICAgc3RhdGljIGltYWdlX2h0dHBfcmVnZXhfNCA9IC8hXFxbW14pXSpcXF1cXChbYS16XVthLXowLTkrXFwtLl0rOlxcL1teKV0qXFwpLztcblxuICAgIC8vIENoZWNrIGlmIFN0cmluZyBpcyBhIGxpbmtcbiAgICBzdGF0aWMgcGF0aF9pc19hX2xpbmsgPSAocGF0aDogc3RyaW5nKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIGxldCBtYXRjaCA9IHBhdGgubWF0Y2goTGlua0hhbmRsZXIubGlua19yZWdleCk7XG4gICAgICAgIHJldHVybiBtYXRjaCA/IHRydWUgOiBmYWxzZVxuICAgIH1cblxuICAgIC8vIENoZWNrIGxpbmUgaWYgaXQgaXMgYSBsaW5rXG4gICAgc3RhdGljIGdldF9saW5rX2luX2xpbmUgPSAobGluZTogc3RyaW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IG1hdGNoXzMgPSBsaW5lLm1hdGNoKExpbmtIYW5kbGVyLmltYWdlX2h0dHBfcmVnZXhfMyk7XG4gICAgICAgIGNvbnN0IG1hdGNoXzQgPSBsaW5lLm1hdGNoKExpbmtIYW5kbGVyLmltYWdlX2h0dHBfcmVnZXhfNCk7XG4gICAgICAgIGlmIChtYXRjaF8zKSB7XG4gICAgICAgICAgICByZXR1cm4geyByZXN1bHQ6IG1hdGNoXzMsIGxpbmtUeXBlOiAzIH07XG4gICAgICAgIH0gZWxzZSBpZiAobWF0Y2hfNCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgcmVzdWx0OiBtYXRjaF80LCBsaW5rVHlwZTogNCB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHJlc3VsdDogZmFsc2UsIGxpbmtUeXBlOiAwIH07XG4gICAgfVxuXG59XG5cbmV4cG9ydCBjbGFzcyBQREZIYW5kbGVyIHtcblxuICAgIC8vIFJlZ2V4IGZvciBbWyBdXSBmb3JtYXRcbiAgICBzdGF0aWMgcGRmX3JlZ2V4XzEgPSAvIVxcW1xcWy4qKHBkZilcXF1cXF0vXG4gICAgc3RhdGljIHBkZl9uYW1lX3JlZ2V4XzEgPSAvKD88PVxcW1xcWykuKi5wZGYvXG5cbiAgICAvLyBSZWdleCBmb3IgIVsgXSggKSBmb3JtYXRcbiAgICBzdGF0aWMgcGRmX3JlZ2V4XzIgPSAvIVxcWyheJHwuKilcXF1cXCguKihwZGYpXFwpL1xuICAgIHN0YXRpYyBwZGZfbmFtZV9yZWdleF8yID0gLyg/PD1cXCgpLioucGRmLztcblxuICAgIC8vIENoZWNrIGxpbmUgaWYgaXQgaXMgYSBQREZcbiAgICBzdGF0aWMgZ2V0X3BkZl9pbl9saW5lID0gKGxpbmU6IHN0cmluZykgPT4ge1xuICAgICAgICBjb25zdCBtYXRjaF8xID0gbGluZS5tYXRjaChQREZIYW5kbGVyLnBkZl9yZWdleF8xKTtcbiAgICAgICAgY29uc3QgbWF0Y2hfMiA9IGxpbmUubWF0Y2goUERGSGFuZGxlci5wZGZfcmVnZXhfMik7XG4gICAgICAgIGlmIChtYXRjaF8xKSB7XG4gICAgICAgICAgICByZXR1cm4geyByZXN1bHQ6IG1hdGNoXzEsIGxpbmtUeXBlOiAxIH1cbiAgICAgICAgfSBlbHNlIGlmIChtYXRjaF8yKSB7XG4gICAgICAgICAgICByZXR1cm4geyByZXN1bHQ6IG1hdGNoXzIsIGxpbmtUeXBlOiAyIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyByZXN1bHQ6IGZhbHNlLCBsaW5rVHlwZTogMCB9XG4gICAgfVxuXG4gICAgc3RhdGljIGdldF9wZGZfbmFtZSA9IChsaW5rVHlwZTogbnVtYmVyLCBtYXRjaDogYW55KTogc3RyaW5nID0+IHtcbiAgICAgICAgbGV0IHBkZl9uYW1lX3JlZ2V4O1xuICAgICAgICBpZiAobGlua1R5cGUgPT0gMSkgcGRmX25hbWVfcmVnZXggPSBQREZIYW5kbGVyLnBkZl9uYW1lX3JlZ2V4XzE7XG4gICAgICAgIGlmIChsaW5rVHlwZSA9PSAyKSBwZGZfbmFtZV9yZWdleCA9IFBERkhhbmRsZXIucGRmX25hbWVfcmVnZXhfMjtcbiAgICAgICAgdmFyIGZpbGVfbmFtZV9tYXRjaCA9IG1hdGNoWzBdLm1hdGNoKHBkZl9uYW1lX3JlZ2V4KTtcbiAgICAgICAgcmV0dXJuIGZpbGVfbmFtZV9tYXRjaFswXVxuICAgIH1cblxufVxuXG5leHBvcnQgY2xhc3MgSW1hZ2VIYW5kbGVyIHtcblxuICAgIC8vIEdlbmVyYWwgSW1hZ2UgUmVnZXggXG4gICAgc3RhdGljIGltYWdlX3JlZ2V4ID0gLy4qLihqcGU/Z3xwbmd8Z2lmfHN2Z3xibXB8ZXhjYWxpZHJhdykvXG5cbiAgICAvLyBSZWdleCBmb3IgW1sgXV0gZm9ybWF0XG4gICAgc3RhdGljIGltYWdlX2xpbmVfcmVnZXhfMSA9IC8hXFxbXFxbLio/KGpwZT9nfHBuZ3xnaWZ8c3ZnfGJtcHxleGNhbGlkcmF3KS4qP1xcXVxcXS87XG4gICAgc3RhdGljIGZpbGVfbmFtZV9yZWdleF8xID0gLyg/PD1cXFtcXFspLiooanBlP2d8cG5nfGdpZnxzdmd8Ym1wfGV4Y2FsaWRyYXcpLztcblxuICAgIC8vIFJlZ2V4IGZvciAhWyBdKCApIGZvcm1hdFxuICAgIHN0YXRpYyBpbWFnZV9saW5lX3JlZ2V4XzIgPSAvIVxcWyheJHwuKj8pXFxdXFwoLio/KGpwZT9nfHBuZ3xnaWZ8c3ZnfGJtcHxleGNhbGlkcmF3KVxcKS87XG4gICAgc3RhdGljIGZpbGVfbmFtZV9yZWdleF8yID0gLyg/PD1cXCgpLiooanBlP2d8cG5nfGdpZnxzdmd8Ym1wfGV4Y2FsaWRyYXcpLztcblxuICAgIC8vIFJlZ2V4IGZvciBMaW5rc1xuICAgIHN0YXRpYyBmaWxlX25hbWVfcmVnZXhfMyA9IC8oPzw9XFxbXFxbKS4qKD89XFx8KXwoPzw9XFxbXFxbKS4qKD89XFxdXFxdKS87XG4gICAgc3RhdGljIGZpbGVfbmFtZV9yZWdleF80ID0gLyg/PD1cXCgpLiooPz1cXCkpLztcblxuICAgIC8vIENoZWNrIGxpbmUgaWYgaXQgaXMgaW1hZ2VcbiAgICBzdGF0aWMgZ2V0X2ltYWdlX2luX2xpbmUgPSAobGluZTogc3RyaW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IG1hdGNoXzEgPSBsaW5lLm1hdGNoKEltYWdlSGFuZGxlci5pbWFnZV9saW5lX3JlZ2V4XzEpO1xuICAgICAgICBjb25zdCBtYXRjaF8yID0gbGluZS5tYXRjaChJbWFnZUhhbmRsZXIuaW1hZ2VfbGluZV9yZWdleF8yKTtcbiAgICAgICAgaWYgKG1hdGNoXzEpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHJlc3VsdDogbWF0Y2hfMSwgbGlua1R5cGU6IDEgfVxuICAgICAgICB9IGVsc2UgaWYgKG1hdGNoXzIpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHJlc3VsdDogbWF0Y2hfMiwgbGlua1R5cGU6IDIgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7IHJlc3VsdDogZmFsc2UsIGxpbmtUeXBlOiAwIH1cbiAgICB9XG5cbiAgICAvLyBJbWFnZSBOYW1lIGFuZCBBbHQgVGV4dFxuICAgIHN0YXRpYyBnZXRGaWxlTmFtZUFuZEFsdFRleHQgPSAobGlua1R5cGU6IG51bWJlciwgbWF0Y2g6IGFueSkgPT4ge1xuICAgICAgICAvKiBcbiAgICAgICAgICAgIGxpbmtUeXBlIDE6ICFbW215aW1hZ2UuanBnfCN4LXNtYWxsXV0sIGxpbmtUeXBlIDM6ICFbW2h0dHBzOi8vaW1hZ2V8I3gtc21hbGxdXSwgXG4gICAgICAgICAgICBsaW5rVHlwZSAyOiAhWyN4LXNtYWxsXShteWltYWdlLmpwZyksICBsaW5rVHlwZSA0OiAhWyN4LXNtYWxsXShodHRwczovL2ltYWdlKSBcbiAgICAgICAgICAgIHJldHVybnMgeyBmaWxlTmFtZTogJycsIGFsdFRleHQ6ICcnIH0gICBcbiAgICAgICAgKi9cbiAgICAgICAgdmFyIGZpbGVfbmFtZV9yZWdleDtcbiAgICAgICAgdmFyIGFsdF9yZWdleDtcbiAgICAgICAgaWYgKGxpbmtUeXBlID09IDEgfHwgbGlua1R5cGUgPT0gMykge1xuICAgICAgICAgICAgaWYgKGxpbmtUeXBlID09IDEpIGZpbGVfbmFtZV9yZWdleCA9IEltYWdlSGFuZGxlci5maWxlX25hbWVfcmVnZXhfMTtcbiAgICAgICAgICAgIGlmIChsaW5rVHlwZSA9PSAzKSBmaWxlX25hbWVfcmVnZXggPSBJbWFnZUhhbmRsZXIuZmlsZV9uYW1lX3JlZ2V4XzM7XG4gICAgICAgICAgICBhbHRfcmVnZXggPSAvKD88PVxcfCkuKig/PV1dKS87XG4gICAgICAgIH0gZWxzZSBpZiAobGlua1R5cGUgPT0gMiB8fCBsaW5rVHlwZSA9PSA0KSB7XG4gICAgICAgICAgICBpZiAobGlua1R5cGUgPT0gMikgZmlsZV9uYW1lX3JlZ2V4ID0gSW1hZ2VIYW5kbGVyLmZpbGVfbmFtZV9yZWdleF8yO1xuICAgICAgICAgICAgaWYgKGxpbmtUeXBlID09IDQpIGZpbGVfbmFtZV9yZWdleCA9IEltYWdlSGFuZGxlci5maWxlX25hbWVfcmVnZXhfNDtcbiAgICAgICAgICAgIGFsdF9yZWdleCA9IC8oPzw9XFxbKSheJHwuKikoPz1cXF0pLztcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBmaWxlX21hdGNoID0gbWF0Y2hbMF0ubWF0Y2goZmlsZV9uYW1lX3JlZ2V4KTtcbiAgICAgICAgdmFyIGFsdF9tYXRjaCA9IG1hdGNoWzBdLm1hdGNoKGFsdF9yZWdleCk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpbGVOYW1lOiBmaWxlX21hdGNoID8gZmlsZV9tYXRjaFswXSA6ICcnLFxuICAgICAgICAgICAgYWx0VGV4dDogYWx0X21hdGNoID8gYWx0X21hdGNoWzBdIDogJydcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIENoZWNraW5nIHRoZSBBbHQgMTAweDEwMCAoV0lEVEh4SEVJR0hUKSBmb3JtYXRcbiAgICBzdGF0aWMgYWx0V2lkdGhIZWlnaHQgPSAoYWx0VGV4dDogc3RyaW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IHdpZHRoSGVpZ2h0UmVnZXggPSAvWzAtOV0reFswLTldKy9cbiAgICAgICAgY29uc3Qgd2lkdGhSZWdleCA9IC9bMC05XSsvXG4gICAgICAgIHZhciBtYXRjaCA9IGFsdFRleHQubWF0Y2god2lkdGhIZWlnaHRSZWdleCk7XG4gICAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gbWF0Y2hbMF0uaW5kZXhPZigneCcpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB3aWR0aDogcGFyc2VJbnQobWF0Y2hbMF0uc3Vic3RyKDAsIGluZGV4KSksXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiBwYXJzZUludChtYXRjaFswXS5zdWJzdHIoaW5kZXggKyAxKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciB3aWR0aE1hdGNoID0gYWx0VGV4dC5tYXRjaCh3aWR0aFJlZ2V4KTtcbiAgICAgICAgICAgIGlmICh3aWR0aE1hdGNoKSByZXR1cm4geyB3aWR0aDogcGFyc2VJbnQod2lkdGhNYXRjaFswXSkgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHBhdGggaXMgYW4gaW1hZ2VcbiAgICBzdGF0aWMgaXNfYW5faW1hZ2UgPSAocGF0aDogc3RyaW5nKSA9PiB7XG4gICAgICAgIHZhciBtYXRjaCA9IHBhdGgubWF0Y2goSW1hZ2VIYW5kbGVyLmltYWdlX3JlZ2V4KTtcbiAgICAgICAgaWYgKG1hdGNoKSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxufVxuXG5leHBvcnQgY2xhc3MgSWZyYW1lSGFuZGxlciB7XG5cbiAgICBzdGF0aWMgaWZyYW1lUmVnZXggPSAvKD86PGlmcmFtZVtePl0qKSg/Oig/OlxcLz4pfCg/Oj4uKj88XFwvaWZyYW1lPikpLztcblxuICAgIHN0YXRpYyBnZXRfaWZyYW1lX2luX2xpbmUgPSAobGluZTogc3RyaW5nKSA9PiB7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gbGluZS5tYXRjaChJZnJhbWVIYW5kbGVyLmlmcmFtZVJlZ2V4KTtcbiAgICAgICAgaWYgKG1hdGNoKSByZXR1cm4geyByZXN1bHQ6IG1hdGNoLCBsaW5rVHlwZTogJ2lmcmFtZScgfTtcbiAgICAgICAgcmV0dXJuIHsgcmVzdWx0OiBmYWxzZSwgbGlua1R5cGU6IDAgfVxuICAgIH1cblxuICAgIHN0YXRpYyBjcmVhdGVfaWZyYW1lX25vZGUgPSAobWF0Y2g6IGFueSk6IEhUTUxFbGVtZW50ID0+IHtcbiAgICAgICAgdmFyIGlmcmFtZU5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgaWZyYW1lTm9kZS5pbm5lckhUTUwgPSBtYXRjaFswXS50cmltKCk7XG4gICAgICAgIHJldHVybiBpZnJhbWVOb2RlO1xuICAgIH1cblxufVxuXG5leHBvcnQgY2xhc3MgT2JzaWRpYW5IZWxwZXJzIHtcblxuICAgIC8vIEdldHRpbmcgQWN0aXZlIE1hcmtkb3duIEZpbGVcbiAgICBzdGF0aWMgZ2V0QWN0aXZlTm90ZUZpbGUgPSAod29ya3NwYWNlOiBXb3Jrc3BhY2UpID0+IHtcbiAgICAgICAgcmV0dXJuIHdvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgfVxuXG4gICAgLy8gR2V0IEFjdGl2ZSBFZGl0b3JcbiAgICBzdGF0aWMgZ2V0Q21FZGl0b3IgPSAod29ya3NwYWNlOiBXb3Jrc3BhY2UpOiBDb2RlTWlycm9yLkVkaXRvciA9PiB7XG4gICAgICAgIHJldHVybiB3b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5zb3VyY2VNb2RlPy5jbUVkaXRvclxuICAgIH1cblxuICAgIC8vIEdldCBGdWxsIFBhdGggb2YgdGhlIGltYWdlXG4gICAgc3RhdGljIGdldFBhdGhPZkltYWdlID0gKHZhdWx0OiBWYXVsdCwgaW1hZ2U6IFRGaWxlKSA9PiB7XG4gICAgICAgIHJldHVybiB2YXVsdC5nZXRSZXNvdXJjZVBhdGgoaW1hZ2UpICsgJz8nICsgaW1hZ2Uuc3RhdC5tdGltZVxuICAgIH1cblxuICAgIHN0YXRpYyBnZXRGaWxlQ21CZWxvbmdzVG8gPSAoY206IENvZGVNaXJyb3IuRWRpdG9yLCB3b3Jrc3BhY2U6IFdvcmtzcGFjZSkgPT4ge1xuICAgICAgICBsZXQgbGVhZnMgPSB3b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFwibWFya2Rvd25cIik7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVhZnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGlmIChsZWFmc1tpXS52aWV3IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3ICYmIGxlYWZzW2ldLnZpZXcuc291cmNlTW9kZT8uY21FZGl0b3IgPT0gY20pIHtcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxlYWZzW2ldLnZpZXcuZmlsZVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxufSIsImltcG9ydCB7IEFwcCwgbm9ybWFsaXplUGF0aCwgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQge1xuICAgIFdpZGdldEhhbmRsZXIsIExpbmtIYW5kbGVyLCBQREZIYW5kbGVyLFxuICAgIEltYWdlSGFuZGxlciwgT2JzaWRpYW5IZWxwZXJzLCBJZnJhbWVIYW5kbGVyXG59IGZyb20gJy4vdXRpbHMnO1xuXG4vLyBDaGVjayBTaW5nbGUgTGluZVxuZXhwb3J0IGNvbnN0IGNoZWNrX2xpbmU6IGFueSA9IGFzeW5jIChjbTogQ29kZU1pcnJvci5FZGl0b3IsIGxpbmVfbnVtYmVyOiBudW1iZXIsIHRhcmdldEZpbGU6IFRGaWxlLCBhcHA6IEFwcCwgc2V0dGluZ3M6IGFueSwgY2hhbmdlZEZpbGVQYXRoPzogc3RyaW5nKSA9PiB7XG5cbiAgICAvLyBHZXQgdGhlIExpbmUgZWRpdGVkXG4gICAgY29uc3QgbGluZSA9IGNtLmxpbmVJbmZvKGxpbmVfbnVtYmVyKTtcbiAgICBpZiAobGluZSA9PT0gbnVsbCkgcmV0dXJuO1xuXG4gICAgLy8gQ2hlY2sgaWYgdGhlIGxpbmUgaXMgYW4gaW50ZXJuZXQgbGlua1xuICAgIGNvbnN0IGxpbmtfaW5fbGluZSA9IExpbmtIYW5kbGVyLmdldF9saW5rX2luX2xpbmUobGluZS50ZXh0KTtcbiAgICBjb25zdCBpbWdfaW5fbGluZSA9IEltYWdlSGFuZGxlci5nZXRfaW1hZ2VfaW5fbGluZShsaW5lLnRleHQpO1xuXG4gICAgLy8gQ2xlYXIgdGhlIHdpZGdldCBpZiBsaW5rIHdhcyByZW1vdmVkXG4gICAgdmFyIGxpbmVfaW1hZ2Vfd2lkZ2V0ID0gbGluZS53aWRnZXRzID8gbGluZS53aWRnZXRzLmZpbHRlcigod2lkOiB7IGNsYXNzTmFtZTogc3RyaW5nOyB9KSA9PiB3aWQuY2xhc3NOYW1lID09PSAnb3otaW1hZ2Utd2lkZ2V0JykgOiBmYWxzZTtcbiAgICBpZiAobGluZV9pbWFnZV93aWRnZXQgJiYgIShpbWdfaW5fbGluZS5yZXN1bHQgfHwgbGlua19pbl9saW5lLnJlc3VsdCkpIGxpbmVfaW1hZ2Vfd2lkZ2V0WzBdLmNsZWFyKCk7XG5cbiAgICAvLyBSZW5kZXIgaUZyYW1lIGlmIGl0IGlzIHR1cm5lZCBvblxuICAgIGlmIChzZXR0aW5ncyAmJiBzZXR0aW5ncy5yZW5kZXJJZnJhbWUpIHtcblxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgbGluZSBpcyBhIElmcmFtZVxuICAgICAgICBjb25zdCBpZnJhbWVfaW5fbGluZSA9IElmcmFtZUhhbmRsZXIuZ2V0X2lmcmFtZV9pbl9saW5lKGxpbmUudGV4dCk7XG5cbiAgICAgICAgLy8gSWYgUmVnZXggTWF0Y2hlc1xuICAgICAgICBpZiAoaWZyYW1lX2luX2xpbmUucmVzdWx0KSB7XG5cbiAgICAgICAgICAgIC8vIENsZWFyIHRoZSBMaW5lIFdpZGdldHNcbiAgICAgICAgICAgIFdpZGdldEhhbmRsZXIuY2xlYXJMaW5lV2lkZ2V0cyhsaW5lKTtcblxuICAgICAgICAgICAgLy8gQ3JlYXRlIElmcmFtZSBOb2RlXG4gICAgICAgICAgICB2YXIgaWZyYW1lTm9kZSA9IElmcmFtZUhhbmRsZXIuY3JlYXRlX2lmcmFtZV9ub2RlKGlmcmFtZV9pbl9saW5lLnJlc3VsdCk7XG5cbiAgICAgICAgICAgIC8vIEFkZCBXaWRnZXQgaW4gTGluZVxuICAgICAgICAgICAgY20uYWRkTGluZVdpZGdldChsaW5lX251bWJlciwgaWZyYW1lTm9kZSwgeyBjbGFzc05hbWU6ICdvei1pbWFnZS13aWRnZXQnIH0pXG5cbiAgICAgICAgICAgIC8vIEVuZCBSZW5kZXJpbmcgb2YgdGhlIGxpbmVcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciBzb3VyY2VQYXRoID0gJyc7XG5cbiAgICAvLyBSZW5kZXIgUERGIGlmIGl0IGlzIHR1cm5lZCBvblxuICAgIGlmIChzZXR0aW5ncyAmJiBzZXR0aW5ncy5yZW5kZXJQREYpIHtcblxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgbGluZSBpcyBhICBQREYgXG4gICAgICAgIGNvbnN0IHBkZl9pbl9saW5lID0gUERGSGFuZGxlci5nZXRfcGRmX2luX2xpbmUobGluZS50ZXh0KTtcblxuICAgICAgICAvLyBJZiBQREYgUmVnZXggTWF0Y2hlc1xuICAgICAgICBpZiAocGRmX2luX2xpbmUucmVzdWx0KSB7XG5cbiAgICAgICAgICAgIC8vIENsZWFyIHRoZSBMaW5lIFdpZGdldHNcbiAgICAgICAgICAgIFdpZGdldEhhbmRsZXIuY2xlYXJMaW5lV2lkZ2V0cyhsaW5lKTtcblxuICAgICAgICAgICAgLy8gR2V0IFNvdXJjZSBQYXRoXG4gICAgICAgICAgICBpZiAodGFyZ2V0RmlsZSAhPSBudWxsKSBzb3VyY2VQYXRoID0gdGFyZ2V0RmlsZS5wYXRoO1xuXG4gICAgICAgICAgICAvLyBHZXQgUERGIEZpbGVcbiAgICAgICAgICAgIHZhciBwZGZfbmFtZSA9IFBERkhhbmRsZXIuZ2V0X3BkZl9uYW1lKHBkZl9pbl9saW5lLmxpbmtUeXBlLCBwZGZfaW5fbGluZS5yZXN1bHQpO1xuXG4gICAgICAgICAgICAvLyBDcmVhdGUgVVJMIGZvciBMaW5rIGFuZCBMb2NhbCBQREYgXG4gICAgICAgICAgICB2YXIgcGRmX3BhdGggPSAnJztcblxuICAgICAgICAgICAgaWYgKExpbmtIYW5kbGVyLnBhdGhfaXNfYV9saW5rKHBkZl9uYW1lKSkge1xuICAgICAgICAgICAgICAgIHBkZl9wYXRoID0gcGRmX25hbWVcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gR2V0IHRoZSBQREYgRmlsZSBPYmplY3RcbiAgICAgICAgICAgICAgICB2YXIgcGRmRmlsZSA9IGFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KGRlY29kZVVSSUNvbXBvbmVudChwZGZfbmFtZSksIHNvdXJjZVBhdGgpO1xuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBPYmplY3QgVVJMXG4gICAgICAgICAgICAgICAgdmFyIGJ1ZmZlciA9IGF3YWl0IGFwcC52YXVsdC5hZGFwdGVyLnJlYWRCaW5hcnkobm9ybWFsaXplUGF0aChwZGZGaWxlLnBhdGgpKTtcbiAgICAgICAgICAgICAgICB2YXIgYXJyID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKTtcbiAgICAgICAgICAgICAgICB2YXIgYmxvYiA9IG5ldyBCbG9iKFthcnJdLCB7IHR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnIH0pO1xuICAgICAgICAgICAgICAgIHBkZl9wYXRoID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBXaWRnZXRcbiAgICAgICAgICAgIHZhciBwZGZfd2lkZ2V0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZW1iZWQnKTtcbiAgICAgICAgICAgIHBkZl93aWRnZXQuc3JjID0gcGRmX3BhdGhcbiAgICAgICAgICAgIHBkZl93aWRnZXQudHlwZSA9ICdhcHBsaWNhdGlvbi9wZGYnXG4gICAgICAgICAgICBwZGZfd2lkZ2V0LndpZHRoID0gJzUwMCdcbiAgICAgICAgICAgIHBkZl93aWRnZXQuaGVpZ2h0ID0gJzY1MCdcblxuICAgICAgICAgICAgLy8gQWRkIFdpZGdldCBpbiBMaW5lXG4gICAgICAgICAgICBjbS5hZGRMaW5lV2lkZ2V0KGxpbmVfbnVtYmVyLCBwZGZfd2lkZ2V0LCB7IGNsYXNzTmFtZTogJ296LWltYWdlLXdpZGdldCcgfSlcblxuICAgICAgICAgICAgLy8gRW5kIFJlbmRlcmluZyBvZiB0aGUgbGluZVxuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBJZiBhbnkgb2YgcmVnZXggbWF0Y2hlcywgaXQgd2lsbCBhZGQgaW1hZ2Ugd2lkZ2V0XG4gICAgaWYgKGxpbmtfaW5fbGluZS5yZXN1bHQgfHwgaW1nX2luX2xpbmUucmVzdWx0KSB7XG5cbiAgICAgICAgLy8gR2V0IHRoZSBmaWxlIG5hbWUgYW5kIGFsdCB0ZXh0IGRlcGVuZGluZyBvbiBmb3JtYXRcbiAgICAgICAgdmFyIGZpbGVuYW1lID0gJyc7XG4gICAgICAgIHZhciBhbHQgPSAnJztcblxuICAgICAgICBpZiAobGlua19pbl9saW5lLnJlc3VsdCkge1xuICAgICAgICAgICAgLy8gbGlua1R5cGUgMyBhbmQgNFxuICAgICAgICAgICAgZmlsZW5hbWUgPSBJbWFnZUhhbmRsZXIuZ2V0RmlsZU5hbWVBbmRBbHRUZXh0KGxpbmtfaW5fbGluZS5saW5rVHlwZSwgbGlua19pbl9saW5lLnJlc3VsdCkuZmlsZU5hbWVcbiAgICAgICAgICAgIGFsdCA9IEltYWdlSGFuZGxlci5nZXRGaWxlTmFtZUFuZEFsdFRleHQobGlua19pbl9saW5lLmxpbmtUeXBlLCBsaW5rX2luX2xpbmUucmVzdWx0KS5hbHRUZXh0XG4gICAgICAgIH0gZWxzZSBpZiAoaW1nX2luX2xpbmUucmVzdWx0KSB7XG4gICAgICAgICAgICBmaWxlbmFtZSA9IEltYWdlSGFuZGxlci5nZXRGaWxlTmFtZUFuZEFsdFRleHQoaW1nX2luX2xpbmUubGlua1R5cGUsIGltZ19pbl9saW5lLnJlc3VsdCkuZmlsZU5hbWU7XG4gICAgICAgICAgICBhbHQgPSBJbWFnZUhhbmRsZXIuZ2V0RmlsZU5hbWVBbmRBbHRUZXh0KGltZ19pbl9saW5lLmxpbmtUeXBlLCBpbWdfaW5fbGluZS5yZXN1bHQpLmFsdFRleHRcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENyZWF0ZSBJbWFnZVxuICAgICAgICBjb25zdCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcblxuICAgICAgICB2YXIgaW1hZ2UgPSBudWxsO1xuXG4gICAgICAgIC8vIFByZXBhcmUgdGhlIHNyYyBmb3IgdGhlIEltYWdlXG4gICAgICAgIGlmIChsaW5rX2luX2xpbmUucmVzdWx0KSB7XG4gICAgICAgICAgICBpbWcuc3JjID0gZmlsZW5hbWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBTb3VyY2UgUGF0aFxuICAgICAgICAgICAgaWYgKHRhcmdldEZpbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHNvdXJjZVBhdGggPSB0YXJnZXRGaWxlLnBhdGg7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxldCBhY3RpdmVOb3RlRmlsZSA9IE9ic2lkaWFuSGVscGVycy5nZXRBY3RpdmVOb3RlRmlsZShhcHAud29ya3NwYWNlKTtcbiAgICAgICAgICAgICAgICBzb3VyY2VQYXRoID0gYWN0aXZlTm90ZUZpbGUgPyBhY3RpdmVOb3RlRmlsZS5wYXRoIDogJyc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBpbWFnZUZpbGUgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChkZWNvZGVVUklDb21wb25lbnQoZmlsZW5hbWUpLCBzb3VyY2VQYXRoKTtcblxuICAgICAgICAgICAgLy8gQWRkaXRpb25hbCBDaGVjayBmb3IgQ2hhbmdlZCBGaWxlcyAtIGhlbHBzIHVwZGF0aW5nIG9ubHkgZm9yIGNoYW5nZWQgaW1hZ2VcbiAgICAgICAgICAgIGlmIChjaGFuZ2VkRmlsZVBhdGggJiYgaW1hZ2VGaWxlICYmIGNoYW5nZWRGaWxlUGF0aCAhPT0gaW1hZ2VGaWxlLnBhdGgpIHJldHVybjtcblxuICAgICAgICAgICAgaWYgKGZpbGVuYW1lLmVuZHNXaXRoKCdleGNhbGlkcmF3JykpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGUgZmlsZSBpcyBhbiBleGNhbGlkcmF3IGRyYXdpbmdcbiAgICAgICAgICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgaWYgKGFwcC5wbHVnaW5zLmdldFBsdWdpbignb2JzaWRpYW4tZXhjYWxpZHJhdy1wbHVnaW4nKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2VGaWxlID09IG51bGwpIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG10aW1lQWx0ID0gaW1hZ2VGaWxlLnN0YXQubXRpbWUgKyAnLScgKyBhbHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2FkZWREcmF3aW5nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW210aW1lQWx0PScke210aW1lQWx0fSddYCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2FkZWREcmF3aW5nID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICAgICAgICAgIEV4Y2FsaWRyYXdBdXRvbWF0ZS5yZXNldCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2UgPSBhd2FpdCBFeGNhbGlkcmF3QXV0b21hdGUuY3JlYXRlUE5HKGltYWdlRmlsZS5wYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGltZy5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGltYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGltZy5zZXRBdHRyKFwibXRpbWVBbHRcIiwgbXRpbWVBbHQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFRoZSBmaWxlIGlzIGFuIGltYWdlXG4gICAgICAgICAgICAgICAgaWYgKGltYWdlRmlsZSA9PSBudWxsKSByZXR1cm47XG4gICAgICAgICAgICAgICAgaW1nLnNyYyA9IE9ic2lkaWFuSGVscGVycy5nZXRQYXRoT2ZJbWFnZShhcHAudmF1bHQsIGltYWdlRmlsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDbGVhciB0aGUgaW1hZ2Ugd2lkZ2V0cyBpZiBleGlzdHNcbiAgICAgICAgV2lkZ2V0SGFuZGxlci5jbGVhckxpbmVXaWRnZXRzKGxpbmUpO1xuXG4gICAgICAgIC8vIEltYWdlIFByb3BlcnRpZXNcbiAgICAgICAgdmFyIGFsdFNpemVyID0gSW1hZ2VIYW5kbGVyLmFsdFdpZHRoSGVpZ2h0KGFsdCk7XG4gICAgICAgIGlmIChhbHRTaXplcikge1xuICAgICAgICAgICAgaW1nLndpZHRoID0gYWx0U2l6ZXIud2lkdGg7XG4gICAgICAgICAgICBpZiAoYWx0U2l6ZXIuaGVpZ2h0KSBpbWcuaGVpZ2h0ID0gYWx0U2l6ZXIuaGVpZ2h0O1xuICAgICAgICB9XG5cbiAgICAgICAgaW1nLmFsdCA9IGFsdDtcblxuICAgICAgICAvLyBBZGQgSW1hZ2Ugd2lkZ2V0IHVuZGVyIHRoZSBJbWFnZSBNYXJrZG93blxuICAgICAgICBjbS5hZGRMaW5lV2lkZ2V0KGxpbmVfbnVtYmVyLCBpbWcsIHsgY2xhc3NOYW1lOiAnb3otaW1hZ2Utd2lkZ2V0JyB9KTtcbiAgICB9XG59XG5cbi8vIENoZWNrIEFsbCBMaW5lcyBGdW5jdGlvblxuZXhwb3J0IGNvbnN0IGNoZWNrX2xpbmVzOiBhbnkgPSAoY206IENvZGVNaXJyb3IuRWRpdG9yLCBmcm9tOiBudW1iZXIsIHRvOiBudW1iZXIsIGFwcDogQXBwLCBzZXR0aW5nczogYW55LCBjaGFuZ2VkRmlsZVBhdGg/OiBzdHJpbmcpID0+IHtcbiAgICAvLyBMYXN0IFVzZWQgTGluZSBOdW1iZXIgaW4gQ29kZSBNaXJyb3JcbiAgICB2YXIgZmlsZSA9IE9ic2lkaWFuSGVscGVycy5nZXRGaWxlQ21CZWxvbmdzVG8oY20sIGFwcC53b3Jrc3BhY2UpO1xuICAgIGZvciAobGV0IGkgPSBmcm9tOyBpIDw9IHRvOyBpKyspIHtcbiAgICAgICAgY2hlY2tfbGluZShjbSwgaSwgZmlsZSwgYXBwLCBzZXR0aW5ncywgY2hhbmdlZEZpbGVQYXRoKTtcbiAgICB9XG59IiwiaW1wb3J0IHsgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgQXBwIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IE96YW5JbWFnZVBsdWdpbiBmcm9tICcuL21haW4nO1xuXG5leHBvcnQgY2xhc3MgT3phbkltYWdlUGx1Z2luU2V0dGluZ3NUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IE96YW5JbWFnZVBsdWdpbjtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IE96YW5JbWFnZVBsdWdpbikge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGxldCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdJbWFnZSBpbiBFZGl0b3IgU2V0dGluZ3MnIH0pO1xuXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ1JlbmRlciBPcHRpb25zJyB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdSZW5kZXIgVG9nZ2xlJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdUdXJuIG9mZiB0aGlzIG9wdGlvbiBpZiB5b3Ugd2FudCB0byBzdG9wIHJlbmRlcmluZyBpbWFnZXMsIFBERiBhbmQgZHJhd2luZ3MuIElmIHlvdSB0dXJuIG9mZiwgdGhlIG90aGVyIHNldHRpbmdzIHdvblxcJ3QgaGF2ZSBhbiBlZmZlY3QnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucmVuZGVyQWxsKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uaGFuZGxlVG9nZ2xlUmVuZGVyQWxsKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVuZGVyQWxsID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApXG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnUmVuZGVyIFBERnMgaW4gRWRpdG9yJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdUdXJuIG9uIHRoaXMgb3B0aW9uIGlmIHlvdSB3YW50IGFsc28gUERGIGZpbGVzIHRvIGJlIHJlbmRlcmVkIGluIEVkaXRvcicpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW5kZXJQREYpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW5kZXJQREYgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIClcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdSZW5kZXIgSWZyYW1lcyBpbiBFZGl0b3InKVxuICAgICAgICAgICAgLnNldERlc2MoJ1R1cm4gb24gdGhpcyBvcHRpb24gaWYgeW91IHdhbnQgaWZyYW1lcyB0byBiZSByZW5kZXJlZCBpbiBFZGl0b3InKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucmVuZGVySWZyYW1lKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVuZGVySWZyYW1lID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApXG5cbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdBbHRlcm5hdGl2ZSBTZXR0aW5ncycgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnUmVmcmVzaCBJbWFnZXMgYWZ0ZXIgQ2hhbmdlcycpXG4gICAgICAgICAgICAuc2V0RGVzYygnVHVybiBvbiB0aGlzIG9wdGlvbiBpZiB5b3Ugd2FudCBpbWFnZXMgdG8gcmVmcmVzaGVkIG9uY2UgeW91IGVkaXQgdGhlIG9yaWdpbmFsIGZpbGUnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucmVmcmVzaEltYWdlc0FmdGVyQ2hhbmdlKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uaGFuZGxlUmVmcmVzaEltYWdlcyh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlZnJlc2hJbWFnZXNBZnRlckNoYW5nZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKVxuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1dZU0lXWUcgTGlrZSBFeHBlcmllbmNlJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdUdXJuIG9uIHRoaXMgb3B0aW9uIGlmIHlvdSB3YW50IFdZU0lXWUcgc3R5bGUgdG8gYmUgbG9hZGVkIGZvciBlZGl0b3IgdmlldycpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5XWVNJV1lHKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuV1lTSVdZRyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5oYW5kbGVXWVNJV1lHKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIClcbiAgICB9XG5cbn0iLCJleHBvcnQgY29uc3QgV1lTSVdZR19TdHlsZSA9IGBcblxuLyogTm90IEFjdGl2ZSBMaW5lcyAqL1xuZGl2Om5vdCguQ29kZU1pcnJvci1hY3RpdmVsaW5lKSA+XG4uQ29kZU1pcnJvci1saW5lIHNwYW4uY20tZm9ybWF0dGluZzpub3QoLmNtLWZvcm1hdHRpbmctbGlzdCkgLyogbm90KC5jbS1mb3JtYXR0aW5nLWNvZGUtYmxvY2spICovIHtcbiAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50O1xufVxuXG4vKiBIMSBVbmRlcmxpbmUgKi9cbi5jbS1zLW9ic2lkaWFuIHByZS5IeXBlck1ELWhlYWRlci0xOmFmdGVyIHtcbiAgY29udGVudDogXCJcIjtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBib3R0b206IDVweDtcbiAgbGVmdDogNXB4O1xuICB3aWR0aDogY2FsYygxMDAlIC0gMTBweCk7XG4gIGhlaWdodDogMXB4O1xuICBiYWNrZ3JvdW5kOiB2YXIoLS10ZXh0LWFjY2VudCk7XG59XG5cbi8qIGV4Y2VwdCBudW1iZXJlZCBsaXN0ICovXG5kaXY6bm90KC5Db2RlTWlycm9yLWFjdGl2ZWxpbmUpPi5Db2RlTWlycm9yLWxpbmUgc3Bhbi5jbS1mb3JtYXR0aW5nLWxpc3Qge1xuICAgZGlzcGxheTogaW5saW5lICFpbXBvcnRhbnQ7XG59XG5cbnNwYW4uY20tZm9ybWF0dGluZy1saXN0LFxuc3Bhbi5jbS1mb3JtYXR0aW5nLWNvZGUtYmxvY2suY20taG1kLWNvZGVibG9jayxcbnNwYW4uY20tZm9ybWF0dGluZy1oZWFkZXIge1xuICBkaXNwbGF5OiBpbmxpbmUgIWltcG9ydGFudDtcbn1cblxuLyogYW5kIHRhc2sgY2hlY2tib3hlcyAqL1xuc3Bhbi5jbS1mb3JtYXR0aW5nLXRhc2sge1xuICBkaXNwbGF5OiBpbmxpbmUgIWltcG9ydGFudDtcbiAgZm9udC1mYW1pbHk6IG1vbm9zcGFjZTtcbn1cblxuLyogaGlnaGxpZ2h0ICg9PSkgbm90IHZpc2libGUgYW55bW9yZSBpZiBub3QgYWN0aXZlIGxpbmUgKi9cbmRpdjpub3QoLkNvZGVNaXJyb3ItYWN0aXZlbGluZSkgPiAuQ29kZU1pcnJvci1saW5lIC5jbS1mb3JtYXR0aW5nLWhpZ2hsaWdodC5jbS1oaWdobGlnaHQge1xuIGZvbnQtc2l6ZTogMDtcbn1cblxuLyogQmxvY2txdW90ZSAqL1xuZGl2Om5vdCguQ29kZU1pcnJvci1hY3RpdmVsaW5lKT4uQ29kZU1pcnJvci1saW5lIHNwYW4uY20tZm9ybWF0dGluZy5jbS1mb3JtYXR0aW5nLXF1b3RlLFxuZGl2Om5vdCguQ29kZU1pcnJvci1hY3RpdmVsaW5lKT4uQ29kZU1pcnJvci1saW5lIHNwYW4uY20taG1kLWluZGVudC1pbi1xdW90ZSB7XG4gIGRpc3BsYXk6IGlubGluZSAhaW1wb3J0YW50O1xuICBjb2xvcjogdHJhbnNwYXJlbnQgIWltcG9ydGFudDtcbn1cblxuZGl2Om5vdCguQ29kZU1pcnJvci1hY3RpdmVsaW5lKT4uSHlwZXJNRC1xdW90ZSB7XG4gICBiYWNrZ3JvdW5kLWNvbG9yOnJnYigyMzgsIDIzNCwgMjM0KTtcbiAgIGJvcmRlci1sZWZ0OiAzcHggc29saWQgdmFyKC0tdGV4dC1zZWxlY3Rpb24pO1xuICAgYm9yZGVyLWNvbG9yOiByZWQgIWltcG9ydGFudDtcbiAgIGZvbnQtc2l6ZTogMTdweDtcbiAgIGxpbmUtaGVpZ2h0OiAxLjVlbTtcbiAgIG1hcmdpbi1sZWZ0OiA1cHg7XG4gICBwYWRkaW5nOiAxMHB4IDZweCAxMHB4IDZweDtcbiAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgIHdpZHRoOiAxMDAlO1xufVxuXG4vKiBUYWdzICovXG5kaXY6bm90KC5Db2RlTWlycm9yLWFjdGl2ZWxpbmUpID4gLkNvZGVNaXJyb3ItbGluZSBzcGFuLmNtLWhhc2h0YWctZW5kOmJlZm9yZSB7XG4gICBjb250ZW50OiAnJztcbn1cblxuLnRhZywgZGl2Om5vdCguQ29kZU1pcnJvci1hY3RpdmVsaW5lKSA+IC5Db2RlTWlycm9yLWxpbmUgc3Bhbi5jbS1oYXNodGFnLWVuZCB7XG4gIGJhY2tncm91bmQtY29sb3I6ICNiZDZiMTk7XG4gIGJvcmRlcjogbm9uZTtcbiAgY29sb3I6IHdoaXRlICFpbXBvcnRhbnQ7XG4gIGZvbnQtc2l6ZTogMTRweDtcbiAgcGFkZGluZzogMHB4IDhweDtcbiAgcGFkZGluZy10b3A6IC0ycHg7XG4gIHBhZGRpbmctYm90dG9tOiAzcHg7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgdGV4dC1kZWNvcmF0aW9uOiBub25lICFpbXBvcnRhbnQ7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgbWFyZ2luOiAxcHggMXB4O1xuICBjdXJzb3I6IHBvaW50ZXI7XG4gIGJvcmRlci1yYWRpdXM6IDE0cHg7XG59XG5cbmAiLCJpbXBvcnQgeyBQbHVnaW4sIFRBYnN0cmFjdEZpbGUsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgT2JzaWRpYW5IZWxwZXJzLCBXaWRnZXRIYW5kbGVyLCBJbWFnZUhhbmRsZXIgfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7IGNoZWNrX2xpbmUsIGNoZWNrX2xpbmVzIH0gZnJvbSAnLi9jaGVjay1saW5lJztcbmltcG9ydCB7IE96YW5JbWFnZVBsdWdpblNldHRpbmdzVGFiIH0gZnJvbSAnLi9zZXR0aW5ncyc7XG5pbXBvcnQgeyBXWVNJV1lHX1N0eWxlIH0gZnJvbSAnLi9jb25zdGFudHMnO1xuXG5pbnRlcmZhY2UgT3phbkltYWdlUGx1Z2luU2V0dGluZ3Mge1xuICAgIHJlbmRlckFsbDogYm9vbGVhbixcbiAgICByZW5kZXJQREY6IGJvb2xlYW4sXG4gICAgcmVuZGVySWZyYW1lOiBib29sZWFuLFxuICAgIHJlZnJlc2hJbWFnZXNBZnRlckNoYW5nZTogYm9vbGVhbixcbiAgICBXWVNJV1lHOiBib29sZWFuLFxufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBPemFuSW1hZ2VQbHVnaW5TZXR0aW5ncyA9IHtcbiAgICByZW5kZXJBbGw6IHRydWUsXG4gICAgcmVuZGVyUERGOiBmYWxzZSxcbiAgICByZW5kZXJJZnJhbWU6IGZhbHNlLFxuICAgIHJlZnJlc2hJbWFnZXNBZnRlckNoYW5nZTogZmFsc2UsXG4gICAgV1lTSVdZRzogZmFsc2Vcbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgT3phbkltYWdlUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcblxuICAgIHNldHRpbmdzOiBPemFuSW1hZ2VQbHVnaW5TZXR0aW5ncztcbiAgICBsb2FkZWRTdHlsZXM6IEFycmF5PEhUTUxTdHlsZUVsZW1lbnQ+O1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBjb25zb2xlLmxvZygnSW1hZ2UgaW4gRWRpdG9yIFBsdWdpbiBpcyBsb2FkZWQnKTtcbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBPemFuSW1hZ2VQbHVnaW5TZXR0aW5nc1RhYih0aGlzLmFwcCwgdGhpcykpO1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuICAgICAgICAvLyBSZWdpc3RlciBldmVudCBmb3IgZWFjaCBjaGFuZ2VcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAndG9nZ2xlLXJlbmRlci1hbGwnLFxuICAgICAgICAgICAgbmFtZTogJ1RvZ2dsZSBSZW5kZXIgQWxsJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVUb2dnbGVSZW5kZXJBbGwoIXRoaXMuc2V0dGluZ3MucmVuZGVyQWxsKTtcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLnJlbmRlckFsbCA9ICF0aGlzLnNldHRpbmdzLnJlbmRlckFsbDtcbiAgICAgICAgICAgICAgICB0aGlzLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5XWVNJV1lHKSB0aGlzLmxvYWRfV1lTSVdZR19TdHlsZXMoKTtcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLnJlbmRlckFsbCkgcmV0dXJuO1xuICAgICAgICB0aGlzLnJlZ2lzdGVyQ29kZU1pcnJvcigoY206IENvZGVNaXJyb3IuRWRpdG9yKSA9PiB7XG4gICAgICAgICAgICBjbS5vbihcImNoYW5nZVwiLCB0aGlzLmNvZGVtaXJyb3JMaW5lQ2hhbmdlcyk7XG4gICAgICAgICAgICB0aGlzLmhhbmRsZUluaXRpYWxMb2FkKGNtKTtcbiAgICAgICAgfSlcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLnJlZnJlc2hJbWFnZXNBZnRlckNoYW5nZSkgcmV0dXJuO1xuICAgICAgICB0aGlzLmFwcC52YXVsdC5vbignbW9kaWZ5JywgdGhpcy5oYW5kbGVGaWxlTW9kaWZ5KTtcbiAgICB9XG5cbiAgICBvbnVubG9hZCgpIHtcbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLml0ZXJhdGVDb2RlTWlycm9ycygoY20pID0+IHtcbiAgICAgICAgICAgIGNtLm9mZihcImNoYW5nZVwiLCB0aGlzLmNvZGVtaXJyb3JMaW5lQ2hhbmdlcyk7XG4gICAgICAgICAgICBXaWRnZXRIYW5kbGVyLmNsZWFyV2lkZ2V0cyhjbSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmFwcC52YXVsdC5vZmYoJ21vZGlmeScsIHRoaXMuaGFuZGxlRmlsZU1vZGlmeSk7XG4gICAgICAgIHRoaXMudW5sb2FkX1dZU0lXWUdfU3R5bGVzKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdJbWFnZSBpbiBFZGl0b3IgUGx1Z2luIGlzIHVubG9hZGVkJyk7XG4gICAgfVxuXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcbiAgICB9XG5cbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgLy8gTGluZSBFZGl0IENoYW5nZXNcbiAgICBjb2RlbWlycm9yTGluZUNoYW5nZXMgPSAoY206IGFueSwgY2hhbmdlOiBhbnkpID0+IHtcbiAgICAgICAgY2hlY2tfbGluZXMoY20sIGNoYW5nZS5mcm9tLmxpbmUsIGNoYW5nZS5mcm9tLmxpbmUgKyBjaGFuZ2UudGV4dC5sZW5ndGggLSAxLCB0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgLy8gT25seSBUcmlnZ2VyZWQgZHVyaW5nIGluaXRpYWwgTG9hZFxuICAgIGhhbmRsZUluaXRpYWxMb2FkID0gKGNtOiBDb2RlTWlycm9yLkVkaXRvcikgPT4ge1xuICAgICAgICB2YXIgbGFzdExpbmUgPSBjbS5sYXN0TGluZSgpO1xuICAgICAgICB2YXIgZmlsZSA9IE9ic2lkaWFuSGVscGVycy5nZXRGaWxlQ21CZWxvbmdzVG8oY20sIHRoaXMuYXBwLndvcmtzcGFjZSk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGFzdExpbmUgKyAxOyBpKyspIHtcbiAgICAgICAgICAgIGNoZWNrX2xpbmUoY20sIGksIGZpbGUsIHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhhbmRsZSBUb2dnbGUgZm9yIHJlbmRlckFsbFxuICAgIGhhbmRsZVRvZ2dsZVJlbmRlckFsbCA9IChuZXdSZW5kZXJBbGw6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgaWYgKG5ld1JlbmRlckFsbCkge1xuICAgICAgICAgICAgdGhpcy5yZWdpc3RlckNvZGVNaXJyb3IoKGNtOiBDb2RlTWlycm9yLkVkaXRvcikgPT4ge1xuICAgICAgICAgICAgICAgIGNtLm9uKFwiY2hhbmdlXCIsIHRoaXMuY29kZW1pcnJvckxpbmVDaGFuZ2VzKTtcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUluaXRpYWxMb2FkKGNtKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5yZWZyZXNoSW1hZ2VzQWZ0ZXJDaGFuZ2UpIHRoaXMuYXBwLnZhdWx0Lm9uKCdtb2RpZnknLCB0aGlzLmhhbmRsZUZpbGVNb2RpZnkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLml0ZXJhdGVDb2RlTWlycm9ycygoY20pID0+IHtcbiAgICAgICAgICAgICAgICBjbS5vZmYoXCJjaGFuZ2VcIiwgdGhpcy5jb2RlbWlycm9yTGluZUNoYW5nZXMpO1xuICAgICAgICAgICAgICAgIFdpZGdldEhhbmRsZXIuY2xlYXJXaWRnZXRzKGNtKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5hcHAudmF1bHQub2ZmKCdtb2RpZnknLCB0aGlzLmhhbmRsZUZpbGVNb2RpZnkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIFRvZ2dsZSBmb3IgUmVmcmVzaCBJbWFnZXMgU2V0dGluZ3NcbiAgICBoYW5kbGVSZWZyZXNoSW1hZ2VzID0gKG5ld1JlZnJlc2hJbWFnZXM6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgaWYgKG5ld1JlZnJlc2hJbWFnZXMpIHtcbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdtb2RpZnknLCB0aGlzLmhhbmRsZUZpbGVNb2RpZnkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5hcHAudmF1bHQub2ZmKCdtb2RpZnknLCB0aGlzLmhhbmRsZUZpbGVNb2RpZnkpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBIYW5kbGUgRmlsZSBDaGFuZ2VzIHRvIFJlZmhyZXMgSW1hZ2VzXG4gICAgaGFuZGxlRmlsZU1vZGlmeSA9IChmaWxlOiBUQWJzdHJhY3RGaWxlKSA9PiB7XG4gICAgICAgIGlmICghKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHJldHVybjtcbiAgICAgICAgaWYgKCFJbWFnZUhhbmRsZXIuaXNfYW5faW1hZ2UoZmlsZS5wYXRoKSkgcmV0dXJuO1xuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuaXRlcmF0ZUNvZGVNaXJyb3JzKGNtID0+IHtcbiAgICAgICAgICAgIHZhciBsYXN0TGluZSA9IGNtLmxhc3RMaW5lKCk7XG4gICAgICAgICAgICBjaGVja19saW5lcyhjbSwgMCwgbGFzdExpbmUsIHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzLCBmaWxlLnBhdGgpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8vIEhhbmRsZSBXWVNJV1lHIFRvZ2dsZVxuICAgIGhhbmRsZVdZU0lXWUcgPSAobmV3V1lTSVdZRzogYm9vbGVhbikgPT4ge1xuICAgICAgICBpZiAobmV3V1lTSVdZRykge1xuICAgICAgICAgICAgdGhpcy5sb2FkX1dZU0lXWUdfU3R5bGVzKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnVubG9hZF9XWVNJV1lHX1N0eWxlcygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbG9hZF9XWVNJV1lHX1N0eWxlcyA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5sb2FkZWRTdHlsZXMgPSBBcnJheTxIVE1MU3R5bGVFbGVtZW50PigwKTtcbiAgICAgICAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuICAgICAgICBzdHlsZS5pbm5lckhUTUwgPSBXWVNJV1lHX1N0eWxlO1xuICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgICAgICAgdGhpcy5sb2FkZWRTdHlsZXMucHVzaChzdHlsZSk7XG4gICAgfVxuXG4gICAgdW5sb2FkX1dZU0lXWUdfU3R5bGVzID0gKCkgPT4ge1xuICAgICAgICBmb3IgKGxldCBzdHlsZSBvZiB0aGlzLmxvYWRlZFN0eWxlcykge1xuICAgICAgICAgICAgZG9jdW1lbnQuaGVhZC5yZW1vdmVDaGlsZChzdHlsZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sb2FkZWRTdHlsZXMgPSBBcnJheTxIVE1MU3R5bGVFbGVtZW50PigwKTtcbiAgICB9XG59Il0sIm5hbWVzIjpbIk1hcmtkb3duVmlldyIsIm5vcm1hbGl6ZVBhdGgiLCJQbHVnaW5TZXR0aW5nVGFiIiwiU2V0dGluZyIsIlBsdWdpbiIsIlRGaWxlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBdURBO0FBQ08sU0FBUyxTQUFTLENBQUMsT0FBTyxFQUFFLFVBQVUsRUFBRSxDQUFDLEVBQUUsU0FBUyxFQUFFO0FBQzdELElBQUksU0FBUyxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsT0FBTyxLQUFLLFlBQVksQ0FBQyxHQUFHLEtBQUssR0FBRyxJQUFJLENBQUMs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
